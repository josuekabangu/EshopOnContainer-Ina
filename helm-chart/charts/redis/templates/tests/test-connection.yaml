apiVersion: v1
kind: Pod
metadata:
  name: test-redis-connection
  namespace: dev
  labels:
    app: test
spec:
  restartPolicy: Never
  containers:
    - name: redis-test
      image: redis:7.2-alpine
      command:
        - sh
        - -c
        - |
          for i in $(seq 1 10); do
            redis-cli -h redis -p 6379 -a redis ping && exit 0
            echo "Waiting for Redis to be ready..."
            sleep 3
          done
          echo "Redis is not ready after 10 attempts."
          exit 1
